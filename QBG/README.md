### 问题记录

##### 2021-09-08

模型的稳健性。目前这个对于边角的预测力很强的模型看起来像是一个很偶然的产物。因为现在用的是Lasso模型，因此根据其系数，可以将目前已经知道的一些事实罗列如下：

-- 系数绝对值最大的几个特征：

日内涨幅除以日内振幅 -0.0243

小单净占比过去10天平均 -0.0159

前3天收益率 -0.0136

今天最低价除以昨天最高价 0.0124

换手率 -0.0111

这说明，单日反转仍然比较重要，但这个特征已知在边角表表现不好；

小单净占比是很强的反转信号，但此时大单占比却系数很小，可能是由于相关性的原因；

换手率单因子已经没有预测力，但是系数不小，可能是降噪的原因；

-- 不同的模型在反转和换手率因子上给的权重差异较大，但在小单净占比上的权重相对稳定，因此这个因子可能确实比较重要

下图是纯根据小单净占比10日平均取负的分层收益图，可见确实在最大的那一档平均收益接近日均1%，所以可能确实这个因子是最重要的。

![image-20210908211006144](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210908211006144.png)

为此，我们尝试了仅仅依靠小单净占比，实际的边缘表现却很差。仍然需要增加许多因子后边缘表现才更好。那么是否还需要增加因子？但是之前11因子时表现更差了。

-- 表现较好的模型的系数有相似之处

##### 2021-09-09

-- 即使能够选出不少因子在边角有不错的表现，但用它们直接做回归，则很不稳定。

-- 将现在的模型放到更长的历史中看，也不是一直都很稳定，一般都在2020年中经历了长达一个季度的回撤

-- 改进方法？首先不应该再使用传统的截面回归，因为它的目标和小额投资的版本目标是不一样的，只是有时候好像可以碰巧选出有用的参数

-- 目前可以尝试用遍历方法遍历参数组合，从而得到最优边角的参数组合——我们要预测准涨的最多的那一批股票（应该测试这种遍历参数的稳定性，也就是不同训练集是不是得到稳定的参数，以及滚动回测）

##### 2021-09-12

-- 通过更长时间的回测，表明边角的表现非常不稳健，仅仅是在最近半年才恰好表现很好；而且在很长的时间里，**超过一半的贡献来自于追高涨停板**，往往是无法交易的；

-- 使用遍历参数的方法做边角回归速度非常慢，参数数量为4时已经基本不可承受，以数十分钟计。该方法应当摒弃；

-- 根据上一周的实操，发现Lasso回归选出的股票经常出现换手率非常低，属于那种半死不活的股票，这种股票其实不应该太相信他们会涨，因此需要增加流动性的选择，至少前500只股票；

-- 仅仅做多空组合，目前策略的超额收益倒是比较稳定，这说明至少目前的因子体系其实算是比较有效；

-- 从今天起改用周频率交易，因为目前每天买卖的交易成本高达千分之二，在日频稳健性没有得到验证的前提下不应再进行日频交易；

-- 从因子组合的分档平均收益收益来看，原先截面大概有1000只股票，分100档时最高分那一档的平均周收益都能达到1%以上，这说明即使只每周选出5只股票，长期应当是可以稳定获得超额收益的。就目前的测试结果来看，即使夏普比不好看，确实可以达到周平均0.8%，但是并不稳定，因为出现过较大波动。这样年均大约40%。从结果来看，这个数字并不合理，如果是线性的预测，应当做到年化100%比较合理；

--  因为是纯多头，因此行业影响较大，因此下一阶段应该考虑加入行业平均收益预测；

##### 2021-09-16

-- 随意扩充因子到40多个之后，long_top_n的策略其实可以提供较为稳定的收益，但是细致研究收益来源可知，**主要的收益来源几乎就是涨停板动量**，换句话说，上一次说的超过一半收益来自于涨停板追高，其实是属于过拟合。使用Lasso和lgbm做boosting，做多5只股票日频的平均收益可以达到0.6%以上，但是这5只股票里往往至少一支是涨停的；

-- 关于追高涨停板，有几个比较重要的实证结果，首先是**涨停的动量几乎全部来自于封板**，如果炸板，平均第二天是没有正收益的，但是作为投资者，其实不能确定最后是否封板，因此需要提高打板的成功率；

-- 如果统计每天逼近涨停板时买入，在全市场下，那么不管是否封板，到第二天收盘的平均收益是千分之2这个级别，也就是每日调仓下无法cover掉手续费，但21年7月至今趋势上稳定；

-- 为此可以有以下几个可能的方法：首先需要给QBG写一个Trader类，这个类专门用于具体逻辑的操作，而不是由模型生成的仓位进行操作；然后至少可以考虑**炸板率和什么有关**，至少行业一定有区别，近期大热的行业应该更有可能封板；因为打板操作只能日内做，在此之前无法实时获得数据，因此最好做一些股票软件可见数据的日内的预测，例如**非一字涨停的股票开盘到涨停的成交量变化**等。

